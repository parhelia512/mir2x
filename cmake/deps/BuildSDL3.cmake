INCLUDE(ExternalProject)

ExternalProject_Add(
    sdl3

    GIT_REPOSITORY "https://github.com/libsdl-org/SDL.git"
    GIT_TAG        "3.2.26"

    SOURCE_DIR "${MIR2X_3RD_PARTY_DIR}/sdl3"
    INSTALL_DIR "${MIR2X_3RD_PARTY_DIR}/sdl3/build/install"

    UPDATE_COMMAND ""
    PATCH_COMMAND ""

    CMAKE_ARGS
        -DSDL_SHARED=OFF
        -DSDL_STATIC=ON
        -DSDL_TEST_LIBRARY=OFF
        -DSDL_TESTS=OFF
        -DSDL_INSTALL_TESTS=OFF
        -DCMAKE_POSITION_INDEPENDENT_CODE=ON
        -DCMAKE_INSTALL_PREFIX=${MIR2X_3RD_PARTY_DIR}/sdl3/build/install
        -DCMAKE_BUILD_TYPE=Release

    LOG_BUILD 1
    LOG_CONFIGURE 1
    LOG_INSTALL 1
)

SET(SDL3_INCLUDE_DIRS "${MIR2X_3RD_PARTY_DIR}/sdl3/build/install/include")
SET(SDL3_LIBRARY_DIR "${MIR2X_3RD_PARTY_DIR}/sdl3/build/install/lib")
SET(SDL3_LIBRARIES    "${CMAKE_STATIC_LIBRARY_PREFIX}SDL3${CMAKE_STATIC_LIBRARY_SUFFIX}")
SET(SDL3MAIN_LIBRARIES "${CMAKE_STATIC_LIBRARY_PREFIX}SDL3main${CMAKE_STATIC_LIBRARY_SUFFIX}")

INCLUDE_DIRECTORIES(SYSTEM ${SDL3_INCLUDE_DIRS})
LINK_DIRECTORIES(${SDL3_LIBRARY_DIR})
ADD_DEPENDENCIES(mir2x_3rds sdl3)
